#!/usr/bin/env bash

set -euo pipefail

current_script_path=${BASH_SOURCE[0]}
plugin_dir=$(dirname "$(dirname "$current_script_path")")

# shellcheck source=./lib/utils.bash
. "${plugin_dir}/lib/utils.bash"

# Get the latest stable version from xcodes (non-beta, non-GM seed)
ensure_xcodes_installed

# Get the latest non-beta, non-prerelease version
# Filter out Beta, GM Seed, Release Candidate lines, keep only stable releases
latest_version=$(xcodes list | grep -E '^[0-9]+\.[0-9]+' | grep -v -E '(Beta|GM Seed|Release Candidate)' | tail -n1 | awk '{print $1}')

printf "%s\n" "$latest_version"
